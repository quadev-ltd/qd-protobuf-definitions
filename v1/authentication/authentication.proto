syntax = "proto3";

import "google/protobuf/timestamp.proto";

package pb_authentication;

option go_package = "./gen/go/pb_authentication";


service AuthenticationService {
    rpc GetPublicKey(GetPublicKeyRequest) returns (GetPublicKeyResponse);
    rpc Register(RegisterRequest) returns (BaseResponse);
    rpc VerifyEmail(VerifyEmailRequest) returns (BaseResponse);
    rpc ResendEmailVerification(ResendEmailVerificationRequest) returns (BaseResponse);
    rpc Authenticate(AuthenticateRequest) returns (AuthenticateResponse);
    rpc RefreshToken(RefreshTokenRequest) returns (AuthenticateResponse);
    rpc ForgotPassword(ForgotPasswordRequest) returns (BaseResponse);
    rpc VerifyResetPasswordToken(VerifyResetPasswordTokenRequest) returns (VerifyResetPasswordTokenResponse);
    rpc ResetPassword(ResetPasswordRequest) returns (BaseResponse);
    rpc UpdateUserProfile(UpdateUserProfileRequest) returns (UpdateUserProfileResponse);
    rpc GetUserProfile(GetUserProfileRequest) returns (GetUserProfileResponse);
}

message GetPublicKeyResponse {
    string public_key = 1;
}

message GetPublicKeyRequest {}

message RegisterRequest {
    string email = 1;
    string password = 2;
    string first_name = 3;
    string last_name = 4;
    google.protobuf.Timestamp date_of_birth = 5;
}

message BaseResponse {
    bool success = 1;
    string message = 2;
}

message VerifyEmailRequest {
    string verification_token = 1;
}

message ResendEmailVerificationRequest {
    string auth_token = 1;
}

message AuthenticateRequest {
    string email = 1;
    string password = 2;
}

message AuthenticateResponse {
    string auth_token = 1;
    google.protobuf.Timestamp auth_token_expiry = 2;
    string refresh_token = 3;
    google.protobuf.Timestamp refresh_token_expiry = 4;
    string user_email = 5;
    string user_id = 6;
}

message RefreshTokenRequest {
    string token = 1;
}

message ForgotPasswordRequest {
    string email = 1; // User's email address to send reset password link.
}

message VerifyResetPasswordTokenRequest {
    string token = 1;
}

message VerifyResetPasswordTokenResponse {
    bool is_valid = 1;
    string message = 2;
  }

message ResetPasswordRequest {
    string token = 1;
    string new_password = 2;
}

message User {
    string user_id = 1;
    string email = 2;
    string first_name = 3;
    string last_name = 4;
    string birthday = 5;
}

message UpdateUserProfileRequest {
    string user_id = 1;
    string first_name = 2;
    string last_name = 3;
    string birthday = 4;
}
  
message UpdateUserProfileResponse {
    User user = 1;
}

message GetUserProfileRequest {
    string user_id = 1;
}
  
message GetUserProfileResponse {
    User user = 1;
}